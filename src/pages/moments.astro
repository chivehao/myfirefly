---
import {getAllPosts, type MomentPost} from '../utils/get-feeds-utils.ts';
import {getEnabledFriends} from "@/config";
import MainGridLayout from "@layouts/MainGridLayout.astro";
import MomentPanel from "@components/controls/MomentPanel.svelte";

// 使用配置文件中的友链数据，按权重排序
const items = getEnabledFriends()
    .filter((f) => f && f.enabled && f.subInMoments && f.rssUrl);
const feedUrls = items.map(({rssUrl}) => rssUrl as string)
const posts: MomentPost[] = await getAllPosts(feedUrls);
---
<MainGridLayout title="朋友圈" description="朋友们的最近更新">
    <MomentPanel sortedPosts={posts} client:only="svelte" />
</MainGridLayout>

