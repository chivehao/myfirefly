---
import {getAllPosts} from '@utils/get-feeds-utils.ts';
import {getEnabledFriends} from "@/content/config";
import MainGridLayout from "@layouts/MainGridLayout.astro";
import MomentPanel from "@components/controls/MomentPanel.svelte";
import {i18n} from "@i18n/translation.ts";
import I18nKey from "@i18n/i18nKey.ts";
import type {MomentPost} from "@/types/moment.ts";

// 使用配置文件中的友链数据，按权重排序
const items = getEnabledFriends()
    .filter((f) => f && f.enabled && f.subInMoments && f.rssUrl);
const feedUrls = items.map(({rssUrl}) => rssUrl as string)
const posts: MomentPost[] = await getAllPosts(feedUrls);
---
<MainGridLayout title={i18n(I18nKey.moments)} description={i18n(I18nKey.momentsDescription)}>
    <MomentPanel sortedPosts={posts} client:only="svelte" />
</MainGridLayout>

